{"version":3,"sources":["todo.js"],"names":["todo","container","document","getElementById","todoList","querySelector","addTodoInput","todos","addEventListener","event","index","children","indexOf","target","closest","action","getAttribute","editTodo","deleteTodo","addTodo","cancelTodo","updateTodo","completeTodo","keyCode","getTodos","_render","selectedIndex","innerHTML","forEach","item","status","title","undefined","select","callback","request","XMLHttpRequest","open","onload","JSON","parse","response","send","postTodos","putTodos","deleteTodos","input","value","unshift","alert","splice","Element","prototype","matches","msMatchesSelector","selector","el","parentElement"],"mappings":"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","file":"todo.js","sourcesContent":["// the todo Revealing Module Pattern\nlet todo = (function() {\n\n  // cache DOM\n  let container = document.getElementById('todo');\n  let todoList = container.querySelector('[data-todo=\"list\"]');\n  let addTodoInput = container.querySelector('[data-todo=\"add-item\"]');\n\n  let todos = [];\n\n  // Bind Event(s) (really it's just one event delegation)\n  container.addEventListener('click', (event) => {\n    // get the index using ES6 destructuring, then back to an array, then indexOf\n    let index = [...todoList.children].indexOf(event.target.closest('[data-todo=\"item\"]') || event.target.closest('[data-todo=\"item-edit\"]'));\n    let action = event.target.getAttribute('data-todo');\n    if (action === 'edit') editTodo(index);\n    else if (action === 'delete') deleteTodo(index);\n    else if (action === 'add') addTodo();\n    else if (action === 'cancel') cancelTodo(index);\n    else if (action === 'update') updateTodo(index);\n    else if (action === 'checkmark') completeTodo(index);\n  });\n\n  container.addEventListener('keydown', (event) => {\n    if (event.keyCode === 13) {\n      let action = event.target.getAttribute('data-todo');\n      if (action === 'add-item') addTodo();\n      else {\n        let index = [...todoList.children].indexOf(event.target.closest('[data-todo=\"item\"]') || event.target.closest('[data-todo=\"item-edit\"]'));\n        if (action === 'edit-item') updateTodo(index);\n      }\n    }\n  });\n\n  container.addEventListener('keyup', (event) => {\n    if (event.keyCode === 27) {\n      let action = event.target.getAttribute('data-todo');\n      let index = [...todoList.children].indexOf(event.target.closest('[data-todo=\"item\"]') || event.target.closest('[data-todo=\"item-edit\"]'));\n      if (action === 'edit-item') cancelTodo(index);\n    }\n  });\n\n  getTodos(_render);\n\n  // _render is the only place we repaint:\n  function _render(selectedIndex) {\n    todoList.innerHTML = '';\n    todos.forEach(item => {\n      if (item.status !== 'edit') {\n        // this one displays the todo item:\n        todoList.innerHTML +=\n          `<li class=\"list-group-item${item.status === 'complete' ? ' is-complete' : ''}\" data-todo=\"item\">\n            <label class=\"form-check-label\" data-todo=\"checkmark\">\n              <input class=\"form-check-input\" type=\"checkbox\" ${item.status === 'complete' ? 'checked' : ''} value=\"\" data-todo=\"checkmark\">${item.title}\n            </label>\n            ${item.status === 'complete' ? '<button class=\"btn btn-sm btn-danger\" data-todo=\"delete\">Delete</button>' : '<button class=\"btn btn-sm btn-default\" data-todo=\"edit\">edit</button>'}\n          </li>`;\n      } else { // This one edits:\n        todoList.innerHTML += `<li class=\"list-group-item edit\" data-todo=\"item-edit\">\n          <input class=\"form-control\" data-todo=\"edit-item\" type=\"text\" value=\"${item.title}\">\n          <button class=\"btn btn-sm btn-default\" data-todo=\"cancel\">Cancel</button>\n          <button class=\"btn btn-sm btn-success\" data-todo=\"update\">Update</button>\n          <button class=\"btn btn-sm btn-danger\" data-todo=\"delete\">Delete</button>\n        </li>`;\n      }\n    });\n    if (selectedIndex !== undefined) {\n      todoList.children[selectedIndex].querySelector('[data-todo=\"edit-item\"]').select();\n    }\n  }\n\n  // RESTful events\n  function getTodos(callback) {\n    let request = new XMLHttpRequest();\n    request.open('GET', 'http://localhost:3000/api/todos', true);\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        // todos = Object.keys(data).map((k) => data[k])\n        todos = JSON.parse(this.response);\n        callback()\n      }\n    };\n    request.send();\n  }\n  function postTodos(){}\n  function putTodos(){}\n  function deleteTodos(){}\n\n  function addTodo(input) {\n    // check if there's an input:\n    input = input || addTodoInput.value;\n    // if either one is an input:\n    if(input) {\n      // add it to the top:\n      todos.unshift({\n        title: input,\n        status: 'open'\n      });\n      // clear out the input\n      addTodoInput.value = '';\n      _render();\n    } else {\n      alert('Please enter a todo item.');\n    }\n  }\n\n  function completeTodo(index) {\n    todos[index].status = todos[index].status === 'open' ? 'complete' : 'open';\n    _render();\n  }\n\n  function editTodo(index) {\n    todos[index].status = 'edit';\n    _render(index);\n  }\n\n  function cancelTodo(index) {\n    todos[index].status = 'open';\n    _render();\n  }\n\n  function updateTodo(index) {\n    todos[index].title = todoList.children[index].querySelector('[data-todo=\"edit-item\"]').value;\n    todos[index].status = 'open';\n    _render();\n  }\n\n  function deleteTodo(index) {\n    // take 1 object out of the array at the index:\n    todos.splice(index, 1);\n    _render();\n  }\n\n  // return the public methods\n  return {\n    addTodo,\n    completeTodo,\n    editTodo,\n    cancelTodo,\n    updateTodo,\n    deleteTodo\n  }\n})();\n\n\nif (!Element.prototype.matches) Element.prototype.matches = Element.prototype.msMatchesSelector;\nif (!Element.prototype.closest) Element.prototype.closest = function (selector) {\n  let el = this;\n  while (el) {\n    if (el.matches(selector)) return el;\n    el = el.parentElement;\n  }\n};"],"sourceRoot":"todo/src/scripts"}