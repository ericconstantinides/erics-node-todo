"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return Array.from(t)}var todo=function(){function t(t){u.innerHTML="",m.forEach(function(t){"edit"!==t.status?u.innerHTML+='<li class="list-group-item'+("complete"===t.status?" is-complete":"")+'" data-todo="item">\n            <label class="form-check-label" data-todo="checkmark">\n              <input class="form-check-input" type="checkbox" '+("complete"===t.status?"checked":"")+' value="" data-todo="checkmark">'+t.title+"\n            </label>\n            "+("complete"===t.status?'<button class="btn btn-sm btn-danger" data-todo="delete">Delete</button>':'<button class="btn btn-sm btn-default" data-todo="edit">edit</button>')+"\n          </li>":u.innerHTML+='<li class="list-group-item edit" data-todo="item-edit">\n          <input class="form-control" data-todo="edit-item" type="text" value="'+t.title+'">\n          <button class="btn btn-sm btn-default" data-todo="cancel">Cancel</button>\n          <button class="btn btn-sm btn-success" data-todo="update">Update</button>\n          <button class="btn btn-sm btn-danger" data-todo="delete">Delete</button>\n        </li>'}),void 0!==t&&u.children[t].querySelector('[data-todo="edit-item"]').select()}function e(t){return t.status>=200&&t.status<300?Promise.resolve(t):Promise.reject(new Error(t.statusText))}function o(t){return t.json()}function n(t){fetch("todos").then(e).then(o).then(function(e){m=e,t()})["catch"](function(t){return console.log("Request failed",t)})}function a(e){var n=this;if(e=e||f.value){var a={title:e,status:"open"};m.push(a),fetch("todos",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)}).then(o).then(function(t){return m[m.length]._id=JSON.parse(n.response)._id})["catch"](function(t){return console.log("Request failed",t)}),f.value="",t()}else alert("Please enter a todo item.")}function s(e,n){m[e].status="open"===m[e].status?"complete":"open",fetch("/todos/"+n,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({title:m[e].title,status:m[e].status})}).then(o).then()["catch"](function(t){return console.log("Request failed",t)}),t()}function d(e){m[e].status="edit",t(e)}function i(e){m[e].status="open",t()}function c(e,n){m[e].title=u.children[e].querySelector('[data-todo="edit-item"]').value,m[e].status="open",fetch("/todos/"+n,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({title:m[e].title,status:m[e].status})}).then(o).then()["catch"](function(t){return console.log("Request failed",t)}),t()}function r(e,n){m.splice(e,1),fetch("/todos/"+n,{method:"DELETE"}).then(o).then()["catch"](function(t){return console.log("Request failed",t)}),t()}var l=document.getElementById("todo"),u=l.querySelector('[data-todo="list"]'),f=l.querySelector('[data-todo="add-item"]'),m=[];return l.addEventListener("click",function(t){var e=[].concat(_toConsumableArray(u.children)).indexOf(t.target.closest('[data-todo^="item"]')),o=e>=0?m[e]._id:null,n=t.target.getAttribute("data-todo");"edit"===n?d(e):"delete"===n?r(e,o):"add"===n?a():"cancel"===n?i(e):"update"===n?c(e,o):"checkmark"===n&&s(e,o)}),l.addEventListener("keydown",function(t){if(13===t.keyCode){var e=t.target.getAttribute("data-todo");if("add-item"===e)a();else{var o=[].concat(_toConsumableArray(u.children)).indexOf(t.target.closest('[data-todo^="item"]')),n=o>=0?m[o]._id:null;"edit-item"===e&&c(o,n)}}}),l.addEventListener("keyup",function(t){if(27===t.keyCode){var e=t.target.getAttribute("data-todo"),o=[].concat(_toConsumableArray(u.children)).indexOf(t.target.closest('[data-todo^="item"]'));"edit-item"===e&&i(o)}}),n(t),{addTodo:a,completeTodo:s,editTodo:d,cancelTodo:i,updateTodo:c,deleteTodo:r}}();Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){for(var e=this;e;){if(e.matches(t))return e;e=e.parentElement}});
//# sourceMappingURL=todo.js.map
